<!DOCTYPE html>
<html lang="es-CL">
<head>
  <%- include('partials/head') %>
</head>
<body class="bg-white text-gray-900">
  <a href="#inicio" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-blue-600 text-white px-3 py-2 rounded">Saltar al contenido</a>

  <header>
    <%- include('partials/nav') %>
  </header>

  <main id="contenido-principal">
    <%- include('components/hero') %>
    <%- include('components/about') %>
    <%- include('components/services') %>
    <%- include('components/testimonials') %>
    <%- include('components/contact') %>
  </main>

  <%- include('partials/footer') %>
  <%- include('partials/whatsapp') %>

  <script>
    // Innovative Mobile Menu with Circular Overlay
    (function(){
      var btn = document.getElementById('navToggle');
      var overlay = document.getElementById('mobile-menu-overlay');
      var closeBtn = document.getElementById('mobile-menu-close');
      
      if (!btn || !overlay || !closeBtn) return;
      
      // Function to open menu
      function openMenu() {
        btn.setAttribute('aria-expanded', 'true');
        btn.classList.add('active');
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent scrolling
      }
      
      // Function to close menu
      function closeMenu() {
        btn.setAttribute('aria-expanded', 'false');
        btn.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = ''; // Restore scrolling
      }
      
      // Toggle menu on button click
      btn.addEventListener('click', function(){
        var expanded = btn.getAttribute('aria-expanded') === 'true';
        if (expanded) {
          closeMenu();
        } else {
          openMenu();
        }
      });
      
      // Close menu on close button click
      closeBtn.addEventListener('click', closeMenu);
      
      // Close menu when clicking on overlay background
      overlay.addEventListener('click', function(e){
        if (e.target === overlay) {
          closeMenu();
        }
      });
      
      // Close menu when clicking on menu items
      overlay.addEventListener('click', function(e){
        if (e.target.classList.contains('mobile-menu-item')) {
          closeMenu();
        }
      });
      
      // Close menu on escape key
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape' && overlay.classList.contains('active')) {
          closeMenu();
        }
      });
      
      // Handle smooth scrolling for anchor links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            // Close mobile menu if open
            if (overlay.classList.contains('active')) {
              closeMenu();
            }
            // Smooth scroll to target
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });
    })();
  </script>
</body>
</html>